import { Agent } from '@/domains/agent/agent.types';

export interface Vulnerabilities {
	vulnerabilities: Vulnerability[];
}

export interface Vulnerability {
	id: string;
	agentId: string;
	severity: Severity;
	type: string;
	description: string;
	firstDetected: Date;
	lastDetected: Date;
	incidents: Incident[];
	detectedOnAgents: Agent[] | null;
	status: VulnerabilityStatus;
}

export enum Severity {
	HIGH = 'HIGH',
	MODERATE = 'MODERATE',
	LOW = 'LOW'
}

export enum VulnerabilityStatus {
	OPEN = 'OPEN',
	INVALID = 'INVALID',
	FIXED = 'FIXED'
}

export interface Incident {
	incidentType: IncidentType;
	httpRequest: HttpRequest | null;
	stackTrace: string[];
	relevantPointInApplication: string;
}

export enum IncidentType {
	SQL_INJECTION = 'SQL_INJECTION',
	XSS = 'XSS',
	CSRF = 'CSRF'
}

export interface SqlInjectionIncident extends Incident {
	query: string;
}

export interface HttpRequest {
	method: string;
	requestURI: string;
	query: string | null;
	body: string | null;
}
