import { AxiosPromise } from 'axios';
import axios from '@/common/util/axios/initialized-axios-wrapper';
import { Vulnerabilities, Vulnerability } from '@/domains/vulnerability/vulnerability.types';

const vulnerabilityApi = {
	getVulnerabilities(): AxiosPromise<Vulnerabilities> {
		return axios.get('/vulnerabilities/');
	},
	getVulnerabilityById(vulnerabilityId: string): AxiosPromise<Vulnerability> {
		return axios.get(`/vulnerabilities/${vulnerabilityId}`);
	},
	deleteVulnerability(vulnerabilityId: string) {
		return axios.delete(`/vulnerabilities/${vulnerabilityId}`);
	},
	flagVulnerabilityAsInvalid(vulnerabilityId: string): AxiosPromise<Vulnerability> {
		return axios.put(`/vulnerabilities/${vulnerabilityId}/invalid`);
	},
	flagVulnerabilityAsFixed(vulnerabilityId: string): AxiosPromise<Vulnerability> {
		return axios.put(`/vulnerabilities/${vulnerabilityId}/fixed`);
	}
};

export default vulnerabilityApi;
