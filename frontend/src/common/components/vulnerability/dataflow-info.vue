<template>
	<v-card class="mt-5">
		<v-card-title>Observed Dataflow</v-card-title>
		<v-card-text>
			<v-row v-if="!!relevantPointInApplication">
				<v-col lg="1" md="2" sm="3" class="text-body-3">Application-Code Entrypoint:</v-col>
				<v-col lg="11" md="10" sm="9"> {{ relevantPointInApplication }}</v-col>
			</v-row>
			<v-row v-if="databaseQuery !== ''">
				<v-col lg="1" md="2" sm="3" class="text-body-3">Database Query:</v-col>
				<v-col lg="11" md="10" sm="9">{{ databaseQuery }}</v-col>
			</v-row>
		</v-card-text>
	</v-card>
</template>

<script lang="ts">
import Vue, { PropType } from 'vue';
import { Incident, SqlInjectionIncident } from '@/domains/vulnerability/vulnerability.types';

export default Vue.extend({
	name: 'DataflowInfo',
	props: {
		incidents: { type: Array as PropType<Incident[]>, default: null }
	},
	computed: {
		databaseQuery(): string {
			if (this.incidents != null && this.incidents.length > 0) {
				const sqlIncident = this.incidents[0] as SqlInjectionIncident;
				return sqlIncident.query;
			}
			return '';
		},
		relevantPointInApplication(): string | null {
			if (this.incidents != null && this.incidents.length > 0) {
				const sqlIncident = this.incidents[0] as SqlInjectionIncident;
				return sqlIncident.relevantPointInApplication;
			}
			return null;
		}
	}
});
</script>
