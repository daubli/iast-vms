<template>
	<v-card class="mt-5">
		<v-card-title>HTTP Request Info</v-card-title>
		<v-card-text>
			<div v-for="httpRequest in httpRequests" :key="httpRequest.requestURI">
				<v-row>
					<v-col lg="1" md="2" sm="3" class="text-body-3">HTTP-Request:</v-col>
					<v-col lg="11" md="10" sm="9">{{ httpRequestURI(httpRequest) }}</v-col>
				</v-row>
				<v-row v-if="isHttpRequestBodyPresent(httpRequest)">
					<v-col cols="2">Body:</v-col>
					<v-col>{{ httpRequestBody(httpRequest) }}</v-col>
				</v-row>
			</div>
		</v-card-text>
	</v-card>
</template>

<script lang="ts">
import Vue, { PropType } from 'vue';
import { HttpRequest } from '@/domains/vulnerability/vulnerability.types';

export default Vue.extend({
	name: 'HttpRequestInfo',
	props: {
		httpRequests: { type: Array as PropType<HttpRequest[]>, default: null }
	},
	methods: {
		httpRequestURI(httpRequest: HttpRequest): string {
			return `${httpRequest.method} ${httpRequest.requestURI}`;
		},
		isHttpRequestBodyPresent(httpRequest: HttpRequest): boolean {
			return !!httpRequest.body;
		},
		httpRequestBody(httpRequest: HttpRequest): string {
			return httpRequest?.body || '';
		}
	}
});
</script>
